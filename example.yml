# --config docker-prefab.yml --push --repo quay.io/lexsca/prefab --target app:200829173900

targets:
  test:
    dockerfile: Dockerfile.test
    depends_on:
      - test-wheels
      - app

  app:
    dockerfile: Dockerfile
    depends_on:
      - app-wheels
      - base

  app-wheels:
    dockerfile: Dockerfile.app-wheels
    depends_on:
      - tools
    watch_files:
      - Dockerfile.app-wheels
      - requirements-app.txt

  test-wheels:
    dockerfile: Dockerfile.test-wheels
    depends_on:
      - tools
    watch_files:
      - Dockerfile.test-wheels
      - requirements-test.txt

  tools:
    dockerfile: Dockerfile.tools
    depends_on:
      - base
    watch_files:
      - Dockerfile.tools

  base:
    dockerfile: Dockerfile.base
    watch_files:
      - Dockerfile.base
